{
	"name": "cricsheet_to_staging",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "cricsheetJSON",
						"type": "DatasetReference"
					},
					"name": "cricsheet"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "innings",
						"type": "DatasetReference"
					},
					"name": "sink2"
				}
			],
			"transformations": [
				{
					"name": "innings"
				}
			],
			"script": "source(output(\n\t\tinfo as (balls_per_over as short, city as string, dates as date[], event as (group as short, match_number as short, name as string), gender as string, match_type as string, match_type_number as short, officials as (match_referees as string[], reserve_umpires as string[], tv_umpires as string[], umpires as string[]), outcome as (by as (runs as short, wickets as short), winner as string), overs as short, player_of_match as string[], players as (Afghanistan as string[], Australia as string[], Bangladesh as string[], England as string[], India as string[], Namibia as string[], {New Zealand} as string[], Pakistan as string[], Scotland as string[], {South Africa} as string[], {Sri Lanka} as string[], {West Indies} as string[]), registry as (people as ({A Nortje} as string, {A Zampa} as string, {AC Agar} as string, {AD Russell} as string, {AF Milne} as string, {AJ Finch} as string, {AJ Hosein} as string, {AK Markram} as string, {AT Holdstock} as string, {AU Rashid} as string, {Afif Hossain} as integer, {Ahsan Raza} as string, {Aleem Dar} as string, {Asghar Stanikzai} as integer, {Asif Ali} as string, {B Fernando} as string, {B Kumar} as string, {B Shikongo} as string, {BM Scholtz} as string, {BTJ Wheal} as string, {Babar Azam} as string, {C Karunaratne} as string, {CB Gaffaney} as string, {CBRLS Kumara} as string, {CD Wallace} as string, {CG Williams} as string, {CH Gayle} as string, {CJ Jordan} as string, {CM Brown} as string, {CN Greaves} as string, {CR Woakes} as string, {CS MacLeod} as string, {CV Varun} as string, {D Pretorius} as string, {D Wiese} as string, {DA Miller} as string, {DA Warner} as string, {DC Boon} as string, {DJ Bravo} as string, {DJ Malan} as string, {DJ Mitchell} as string, {DP Conway} as string, {E Lewis} as string, {EJG Morgan} as string, {Fakhar Zaman} as string, {GD Phillips} as string, {GJ Maxwell} as string, {Gulbadin Naib} as string, {H Klaasen} as string, {HDPK Dharmasena} as string, {HE van der Dussen} as double, {HG Munsey} as string, {HH Pandya} as string, {HN Ya France} as string, {HR Walsh} as string, {Hamid Hassan} as string, {Haris Rauf} as string, {Hasan Ali} as string, Hazratullah as string, {IS Sodhi} as string, {Imad Wasim} as string, {Ishan Kishan} as string, {J Srinath} as string, {JC Buttler} as string, {JDS Neesham} as string, {JH Davey} as string, {JJ Bumrah} as string, {JJ Crowe} as double, {JJ Roy} as string, {JJ Smit} as string, {JM Bairstow} as string, {JN Frylinck} as string, {JN Loftie-Eaton} as string, {JO Holder} as string, {JR Hazlewood} as string, {JS Wilson} as string, {K Rabada} as string, {KA Maharaj} as string, {KA Pollard} as string, {KIC Asalanka} as string, {KJ Coetzer} as string, {KL Rahul} as string, {KS Williamson} as string, {Karim Janat} as integer, {L Rusere} as string, {LMP Simmons} as string, {LS Livingstone} as string, {Liton Das} as string, {M Erasmus} as string, {M Theekshana} as string, {M van Lingen} as string, {MA Gough} as string, {MA Leask} as integer, {MA Starc} as string, {MD Shanaka} as string, {MDKJ Perera} as string, {MG Erasmus} as string, {MH Cross} as string, {MJ Guptill} as string, {MJ Santner} as string, {MM Ali} as string, {MP Stoinis} as string, {MR Marsh} as string, {MRJ Watt} as string, {MS Wade} as string, {Mahedi Hasan} as string, Mahmudullah as string, {Mohammad Hafeez} as string, {Mohammad Nabi} as string, {Mohammad Naim} as string, {Mohammad Nawaz} as string, {Mohammad Rizwan} as string, {Mohammad Saifuddin} as string, {Mohammad Shahzad} as string, {Mohammed Shami} as string, {Mujeeb Ur Rahman} as string, {Mushfiqur Rahim} as string, {Mustafizur Rahman} as string, {N Pooran} as string, {Najibullah Zadran} as string, {Nasum Ahmed} as string, {Naveen-ul-Haq} as string, {Nitin Menon} as string, {Nurul Hasan} as string, {OC McCoy} as string, {P Nissanka} as string, {P Wilson} as string, {PBB Rajapaksa} as string, {PJ Cummins} as string, {PR Reiffel} as string, {PVD Chameera} as string, {PWH de Silva} as string, {Q de Kock} as string, {R Rampaul} as string, {R Trumpelmann} as string, {RA Jadeja} as string, {RA Kettleborough} as double, {RD Berrington} as string, {RG Sharma} as string, {RJ Tucker} as string, {RK Illingworth} as integer, {RL Chase} as string, {RR Hendricks} as string, {RR Pant} as string, {RS Madugalle} as string, {Rahmanullah Gurbaz} as string, {Rashid Khan} as string, {SA Yadav} as string, {SJ Baard} as string, {SM Sharif} as string, {SN Thakur} as string, {SO Hetmyer} as string, {SPD Smith} as string, {SW Billings} as string, {Shadab Khan} as string, {Shaheen Shah Afridi} as string, {Shakib Al Hasan} as string, {Shamim Hossain} as string, {Shoaib Malik} as string, {Shoriful Islam} as string, {Soumya Sarkar} as string, {T Bavuma} as string, {T Shamsi} as string, {TA Boult} as string, {TG Southee} as string, {TL Seifert} as string, {TS Mills} as string, {Taskin Ahmed} as string, {Usman Ghani} as string, {V Kohli} as string, {WIA Fernando} as double, {ZE Green} as string)), season as string, team_type as string, teams as string[], toss as (decision as string, winner as string), venue as string),\n\t\tinnings as (overs as (deliveries as (batter as string, bowler as string, extras as (byes as short, legbyes as short, noballs as boolean, wides as short), non_striker as string, replacements as (role as (in as string, out as string, reason as string, role as string)[]), review as (batter as string, by as string, decision as string, umpire as string, umpires_call as boolean), runs as (batter as short, extras as short, total as short), wickets as (fielders as (name as string, substitute as boolean)[], kind as string, player_out as string)[])[], over as short)[], powerplays as (from as double, to as double, type as string)[], target as (overs as short, runs as short), team as string)[],\n\t\tmeta as (created as date, data_version as string, revision as boolean)\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false,\n\tlimit: 10,\n\tignoreNoFilesFound: false,\n\trowUrlColumn: 'filename',\n\tdocumentForm: 'singleDocument',\n\twildcardPaths:['*.json']) ~> cricsheet\ncricsheet foldDown(unroll(innings),\n\tmapColumn(\n\t\tfilename,\n\t\tevent_name = info.event.name,\n\t\tmatch_number = info.event.match_number,\n\t\tinnings = innings\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> innings\ninnings sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tevent_name as string,\n\t\tmatch_number as integer,\n\t\tfilename as string,\n\t\tinnings as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tevent_name,\n\t\tmatch_number,\n\t\tfilename,\n\t\tinnings = innings.team\n\t)) ~> sink2"
		}
	}
}